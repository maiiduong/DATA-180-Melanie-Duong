---
title: "HW 2: Visualization, Base R"
subtitle: "Data 180, Professor Kennedy"
author: 
  name: "Melanie Duong"
  email: "duongng@dickinson.edu"
date: '`r format(Sys.Date(), "%B %d, %Y")`' # no need to change date since this line grabs today's date
output: 
  html_document
---

Make sure that you have accepted the hw invitation link, and working with your clone repository.

**Due date:** September 28 beginning of class.

**Reminder:** You can insert R code in your Rmd file as a chunk in the following way:
```{r}
# Your code goes here
```
Make sure to insert a chunk for each (sub)section of the assignment.

**Theme of the assignment**: Let's practice visualization using base R and create cool maps. Load in the `Cars93` dataset by running the following code chunk:

```{r}
library(MASS)
data(Cars93)
```

The library function will load and attach add-on packages that have been previously installed on your machine. This will give you access to the functions and datasets available in the package. In general, you only need to install a package once (although it may require updating from time to time) but you need to access it using the library command every time you start a new session in R (and want the functionality). 

The questions below use the `Cars93` data frame as a source of data. This data frame is part of the MASS package and becomes available after loading it. You can get a view of the top of the data frame by using the head command. For more information, type `?Cars93`. Let's load `Cars93` in,
```{r}
head(Cars93)
```

# Base R
## Task 1
a) Create a Frequency table and Relative Frequency table (latter uses percentages) for the variable `Type`. Make sure to round all digits to 3 digits.
```{r}
data <- data.frame(
  Manufacturer = c("Acura", "Acura", "Audi", "Audi", "BMW", "Buick"),
  Model = c("Integra", "Legend", "90", "100", "535i", "Century"),
  Type = c("Small", "Midsize", "Compact", "Midsize", "Midsize", "Midsize"),
  Min.Price = c(12.9, 29.2, 25.9, 30.8, 23.7, 14.2),
  Price = c(15.9, 33.9, 29.1, 37.7, 30.0, 15.7)
)
freq_table = table(data$Type)
freq_table <- round(freq_table, 3)
freq_table

relative_freq_table <- prop.table(freq_table)*100
relative_freq_table <- round(relative_freq_table, 3)
relative_freq_table
```
b) Create a frequency bar graph for the variable `Type`. You can have count on the y axis.
```{r}
library(ggplot2)
bargraph <- ggplot(data = data.frame(Type = names(freq_table), Count = as.vector(freq_table)), aes(x = Type, y = Count, fill = Type)) + 
                     geom_bar(stat = "identity", cex=1.2) +
                     labs(title = "Frequency Bar Graph for Type", x = "Type", y = "Count") + guides(fill = "none")
bargraph

```

*	Your axes should be labeled and legible
*	The bars should be of different colors
*	The plot should include a title using the main argument
*	The names, labels, and axes sizes (cex parameter) should be set to 1.2

c) Create a pie chart of the variable `Type`.
```{r}
piechart <- pie(freq_table, labels = freq_table, main = "Frequency of Type", col = c(2,3,4), cex=1.2)
legend("topright", legend = names(freq_table), fill = c(2,3,4))
piechart
```

* The plot should include a title using the main argument.
*	The names, labels, and axes sizes (cex parameter) should be set to 1.2

d) What is the mode of the variable `Type`? Comment.
#The mode of variable Type is Midsize.

## Task 2 
a) Create a histogram of the variable `Horsepower`.
```{r}
df <- data.frame(Horsepower = c(140, 200, 172,172,208,110))
histogram <- hist(df$Horsepower, breaks = 5, col = "lightpink", xlab = "Horsepower", ylab = "Frequency", main = "Histogram of Horsepower", cex.lab=1.2, cex.axis=1.2)
histogram
```

*	Your axes should be labeled
*	The hist body should have a color (your choice, not too dark to obscure lines) 
*	The plot should include a title using the main argument
*	The names, labels, and axes sizes should be set to 1.2

b) Create a second histogram with breaks at 25 HP increments instead of 50.
```{r}
df <- data.frame(Horsepower = c(140, 200, 172,172,208,110))
breaks <- seq(0, max(df)+25, by = 25)
histogram <- hist(df$Horsepower, breaks = breaks, col = "lightpink", xlab = "Horsepower", ylab = "Frequency", main = "Histogram of Horsepower(25 HP Increments)", cex.lab=1.2, cex.axis=1.2)
histogram
```

* Use the breaks argument to define the classes
* Other setting should be as in part (a)

c) Which histogram more closely follows or rule of thumb for the suggested number of classes? Explain.
```{r}

```


## Task 3 
a) What is the type of variable `Passengers`? (Categorical nominal/ordinal or Numerical discrete/continuous?) What happens if we were to make a histogram for `Passengers`? What is the problem with this graph?
```{r}
#The type of variable "Passengers" is Numerical discrete because it represents counts and it takes on distinct and separate values.
#If we make a histogram for "Passengers", it will not be an useful graph because a histogram would create arbitrary width bins and would not convey any meaningful information about the distribution.Histogram is more appropriate for numerical continuous variable.
```

b) Correct the problem in part (a) by creating a more appropriate visualization. Make sure to label your axes, place a title, choose a custom color as in the previous graphs. (Bonus: use factor() with levels option to display x axis values with no observations on the plot.)
```{r}
data <-data.frame(Passengers = c(5,5,5,6,4,6))
bargraph <- ggplot(data, aes(x = factor(Passengers))) + geom_bar(fill = "lightpink", color = "black") + labs(title = "Bar chart of Passengers", x = "Passengers", y = "Count")

bargraph
```

## Task 4 
a) Make a histogram of the variable `Length` (the default breaks are fine). Other aspects of the plot should be as in part (a) in Task 2.
```{r}

```

b) What is the shape of the distribution?


c) Find the mean and median of the variable `Length.` Do these answers meet your expectations from part (b)?
```{r}

```

You are done! 🏁 Don't forget to commit and push your .Rmd file to your Github repository before the due date.


